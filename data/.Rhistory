by_7.0 <- gpa_data %>%
group_by(gpa > 7.0) %>%
count(policy) %>%
mutate(percentage = n / nrow(gpa_data))
by_7.0
diff_7.0 <- by_7.0[4, 3] - by_7.0[3, 3]
by_8.5 <- gpa_data %>%
group_by(gpa > 8.5) %>%
count(policy) %>%
mutate(percentage = n / nrow(gpa_data))
by_8.5
diff_8.5  <- by_8.5[4, 3] - by_8.5[3, 3]
diff_7.0
diff_7.9
diff_8.5
diff_7.0 / nrow(gpa_data) # max percentage difference in policies
diff_7.9 / nrow(gpa_data) # max percentage difference in policies
policy_a <- rep("policy_a", times = n_obs)
policy_b <- rep("policy_a", times = n_obs)
policy <- factor(c(policy_a, policy_b))
gpa_data <- tibble(
gpa = gpa,
policy = policy
)
# kuva jakaumista
ggplot(gpa_data, aes(x = gpa, fill = policy)) +
geom_histogram(binwidth = 0.25,
alpha = 0.5,
position = "identity")
policy_b <- rep("policy_ab", times = n_obs)
policy_b <- rep("policy_b", times = n_obs)
policy <- factor(c(policy_a, policy_b))
gpa_data <- tibble(
gpa = gpa,
policy = policy
)
# kuva jakaumista
ggplot(gpa_data, aes(x = gpa, fill = policy)) +
geom_histogram(binwidth = 0.25,
alpha = 0.5,
position = "identity")
# keskiarvorajojen mukaiset erot polivy a ja b ryhmien koossa
by_7.9 <- gpa_data %>%
group_by(gpa > 7.9) %>%
count(policy) %>%
mutate(percentage = n / nrow(gpa_data))
by_7.9
diff_7.9 <- by_7.9[4, 3] - by_7.9[3, 3]
by_7.0 <- gpa_data %>%
group_by(gpa > 7.0) %>%
count(policy) %>%
mutate(percentage = n / nrow(gpa_data))
by_7.0
diff_7.0 <- by_7.0[4, 3] - by_7.0[3, 3]
by_8.5 <- gpa_data %>%
group_by(gpa > 8.5) %>%
count(policy) %>%
mutate(percentage = n / nrow(gpa_data))
by_8.5
diff_8.5  <- by_8.5[4, 3] - by_8.5[3, 3]
diff_7.0
diff_7.9
diff_8.5
diff_7.0 / nrow(gpa_data) # max percentage difference in policies
install.packages("pxweb")
library(pxweb)
pxweb::interactive_pxweb(api = 'pxnet2.stat.fi')
?library
install.packages("refset")
?ggpairs
?plot
?plot
install.packages("ggfortify")
autoplot(lm(Points ~ gender + Age + Attitude, data = regr_analysis))
ggfortify::autoplot(lm(Points ~ gender + Age + Attitude, data = regr_analysis))
ggfortify::autoplot(lm(Points ~ Attitude, data = regr_analysis))
ggfortify::autoplot(lm(Points ~ Attitude, data = regr_analysis))
autoplot(lm(Points ~ Attitude, data = regr_analysis))
ggplot2::autoplot(lm(Points ~ Attitude, data = regr_analysis))
regr_analysis <- as_tibble(read.table("learning2014.txt"))
library(ggfortify, ggplot2)
?autoplot
?ggtitle
library(tidyverse)
# reading data
student_mat <- as_tibble(read.csv2("student-mat.csv"))
student_por <- as_tibble(read.csv2("student-por.csv"))
setwd("~/GitHub/IODS-project/data")
setwd("~/GitHub/IODS-project/data")
library(tidyverse)
# reading data
student_mat <- as_tibble(read.csv2("student-mat.csv"))
# reading data
student_mat <- as_tibble(read.csv2("student-mat.csv"))
student_por <- as_tibble(read.csv2("student-por.csv"))
# dimensions and structure of the data
student_mat # the data has 395 rows and 33 variables
str(student_mat)
str(student_mat)
str(student_por)
inner_join(student_mat, student_por,
by = c("school", "sex", "age",
"address", "famsize", "Pstatus",
"Medu", "Fedu", "Mjob", "Fjob",
"reason", "nursery","internet"))
# joining the two data sets
join_by  <- c("school", "sex", "age",
"address", "famsize", "Pstatus",
"Medu", "Fedu", "Mjob", "Fjob",
"reason", "nursery","internet")
mat_por <- inner_join(student_mat, student_por,
by = join_by)
mat_por
glimpse(mat_por)
str(mat_por)
math_por <- inner_join(student_mat, student_por,
by = join_by)
math_por
math_por
?select
joined_cols <- select(math_por, one_of(join_by))
joined_cols
colnames(math_por)
names(math_por)
notjoined_columns <- names(student_mat) %>%
filter(!names(student_mat) %in% join_by)
notjoined_columns <-
names(student_mat)[!names(student_mat) %in% join_by]
notjoined_columns
notjoined_colnames <-
names(student_mat)[!names(student_mat) %in% join_by]
notjoined_colnames
joined_cols %>% select(two_columns, 1)[[1]]
select(joined_cols, 1)[[1]]
select(joined_cols, 1)[1]
class(select(joined_cols, 1)[1])
class(select(joined_cols, 1)[[1]])
joined_cols[column_name] <- round(rowMeans(two_columns))
for(column_name in notjoined_colnames) {
two_columns <- select(math_por, starts_with(column_name))
first_column <- select(two_columns, 1)[[1]]
if(is.numeric(first_column)) {
joined_cols[column_name] <- round(rowMeans(two_columns))
} else {
joined_cols[column_name] <- first_column
}
}
glimpse(joined_cols)
math_por
glimpse(math_por)
joined_cols
joined_cols %>%
mutate(alc = (Dalc + Walc) / 2) select(alc)
joined_cols %>%
mutate(alc = (Dalc + Walc) / 2) %>% select(alc)
joined_cols %>%
mutate(alc = (Dalc + Walc) / 2) %>% select(Dalc, Walc, alc)
joined_cols %>%
mutate(alc = (Dalc + Walc) / 2,
high_use = ifelse(alc > 2, TRUE, FALSE)) %>% select(Dalc, Walc, alc)
joined_cols %>%
mutate(alc = (Dalc + Walc) / 2,
high_use = ifelse(alc > 2, TRUE, FALSE)) %>%
select(Dalc, Walc, alc, high_use)
alc <- joined_cols %>%
mutate(alc = (Dalc + Walc) / 2,
high_use = ifelse(alc > 2, TRUE, FALSE))
glimpse(alc)
alc
?write.csv2
# computing variables of alcohol consumption
alc <- joined_cols %>%
mutate(alc = (Dalc + Walc) / 2,
high_use = alc > 2)
alc
glimpse(alc)
# define the plot as a bar plot and draw it
g1 + geom_bar()
g1 <- ggplot(data = alc, aes(x = alc_use))
# define the plot as a bar plot and draw it
g1 + geom_bar()
# computing variables of alcohol consumption
alc <- joined_cols %>%
mutate(alc_use = (Dalc + Walc) / 2,
high_use = alc_use > 2)
alc
g1 <- ggplot(data = alc, aes(x = alc_use))
# define the plot as a bar plot and draw it
g1 + geom_bar()
gather(alc) %>% glimpse()
%>% glimpse()
gather(alc)
gather(alc) %>% ggplot(aes(value)) +
facet_wrap("key", scales = "free")
alc %>% group_by(sex) %>% summarise(count = n())
alc %>% count(sex)
alc %>% count(sex, high_use)
g1 <- ggplot(alc, aes(x = high_use, y = G3))
# define the plot as a boxplot and draw it
g1 + geom_boxplot() + ylab("grade")
?read_csv
url_Data <- "http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/alc.txt"
library(tidyverse)
url_data <- "http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/alc.txt"
alc <- read.txt(url_data, sep = ",")
alc <- read.table(url_data, sep = ",")
alc
?read.table
alc <- read.table(url_data, sep = ",", header = TRUE)
alc
alc
alc <- read_table(url_data, sep = ",", header = TRUE)
alc <- read.table(url_data, sep = ",", header = TRUE) %>%
as_tibble
alc
?read.table
alc
```{r echo = FALSE}
names(alc)
alc2 <- alc %>% select(sex, Medu, activities, G3, alc_use, high_use)
alc_2
alc2 <- alc %>% select(sex, Medu, activities, G3, alc_use, high_use)
url_data <-
"http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/alc.txt"
alc <- read.table(url_data, sep = ",", header = TRUE) %>%
as_tibble
alc <- read.table(url_data, sep = ",", header = TRUE) %>%
as_tibble
alc2 <- alc %>% select(sex, Medu, activities, G3, alc_use, high_use)
alc
alc2
library(tidyverse, GGally)
GGally::ggpairs(alc2, mapping = aes(alpha = 0.3),
lower = list(combo = GGally::wrap("facethist", bins = 20)),
title = "Fig 1. Descriptive statistics and relationships between variables.")
table(alc2$sex)
table(alc2$sex, Medu)
table(alc2$sex, alc2$Medu)
ggplot(alc2, aes(x = sex)) +
geom_bar()
ggplot(alc2, aes(x = activities)) +
geom_bar() +
ggtitle("Extra curricular activites")
ggplot(alc2, aes(x = alc_use)) +
geom_boxplot() +
ggtitle("Extracurricular activites")
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ggtitle("Alcohol use")
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (0 = low, 5 = high)")
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (0 = low, 5 = high)") +
ggtitle("Alcohol use")
ggplot(alc2, aes(y = G3)) +
geom_boxplot() +
ylab("School achievement") +
ggtitle("Achivenment")
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by sex") +
facet_wrap(~ sex)
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by maternal education") +
facet_wrap(~ Medu)
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by maternal education") +
facet_wrap(~ Medu, nrow = 1)
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by extracurricular activities") +
facet_wrap(~ activities, nrow = 1)
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by extracurricular activities") +
facet_wrap(~ activities, nrow = 1)
ggplot(alc2, aes(y = alc_use)) +
geom_jitter() +
geom_smooth() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
xlab("School achievement)") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter() +
geom_smooth() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
xlab("School achievement)") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter() +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement)") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(y = alc_use)) +
geom_boxplot() +
ylab("Alcohol use (1 = very low, 5 = very high)") +
ggtitle("Alcohol use by extracurricular activities") +
facet_wrap(~ activities, nrow = 1)
?geom_smooth
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter() +
geom_smooth(aes(color = sex)) +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter() +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter() +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter(alpha = 0.6) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter(alpha = 0.3) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.3) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
alc2
?jitter
ggplot(alc2, aes(x = alc_use, y = jitter(G3), color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = jitter(G3), color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = jitter(alc_use), y = jitter(G3), color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = jitter(alc_use), y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = jitter(alc_use), y = jitter(G3), color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter(alpha = 0.3) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
```{r message = FALSE}
ggplot(alc2, aes(x = alc_use, y = G3)) +
geom_jitter(alpha = 0.3) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth() +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth(aes(x = jitter(alc_use))) +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
```{r message = FALSE}
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth(aes(x = jitter(alc_use))) +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth(aes(x = jitter(alc_use))) +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
ggplot(alc2, aes(x = alc_use, y = G3, color = sex)) +
geom_jitter(alpha = 0.5) +
geom_smooth(aes(x = jitter(alc_use))) +
xlab("Alcohol use (1 = very low, 5 = very high)") +
ylab("School achievement") +
ggtitle("Alcohol use and school achievement")
m <- glm(high_use ~ Medu + sex + activities + G3, data = alc2, family = "binomial")
OR <- coef(m) %>% exp
cbind(OR, CI)
CI <- confint(m) %>% exp
cbind(OR, CI)
m
summary(m)
round(cbind(OR, CI))
?round
round(cbind(OR, CI), digits = 2)
m[, 4]
summary(m)[4]
summary(m)[, 4]
summary(m)[, 3]
summary(m)$Pr(>|z|)
summary(m)[1, ]
summary(m)[1]
summary(m)[4]
summary(m)[3]
summary(m)[2]
summary(m)[5]
summary(m)[6]
summary(m)[7]
summary(m)[9]
m <- glm(high_use ~ Medu + sex + activities + G3, data = alc2, family = "binomial")
summary(m)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
round(cbind(OR, CI), digits = 2)
or_ci <- round(cbind(OR, CI), digits = 2)
names(or_ci)
or_ci
OR
CI
or_ci <- round(cbind(OR[2:5], CI[2:5, ]), digits = 2)
or_ci
or_ci <- round(cbind(or = OR[2:5], CI[2:5, ]), digits = 2)
or_ci
round(cbind(OR, CI, digits = 2)
round(cbind(OR, CI, digits = 2))
round(cbind(OR, CI, digits = 2))
round(cbind(OR, CI), digits = 2))
round(cbind(OR, CI), digits = 2)
names(alc)
predict(m)
predict(m, type = "response")
?predict
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = "probability > 0.5)
)
alc <- mutate(alc, prediction = probability > 0.5)
select(alc, failures, absences, sex, high_use, probability, prediction) %>% tail(10)
table(high_use = alc$high_use, prediction = alc$prediction)
g <- ggplot(alc, aes(x = probability, y = high_use))
g + geom_point()
g + geom_point((aes(col = prediction))
)
table(high_use = alc$high_use, prediction = alc$prediction)
table(high_use = alc$high_use, prediction = alc$prediction) %>%
addmargins(prop.table)
table(high_use = alc$high_use, prediction = alc$prediction) %>%
addmargins(prop.table())
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table()
table(high_use = alc$high_use, prediction = alc$prediction) %>% prop.table() %>% addmargins()
g + geom_jitter((aes(col = prediction), alpha = 0.4)
g + geom_jitter((aes(col = prediction, alpha = 0.4))
g + geom_jitter((aes(col = prediction, alpha = 0.4)))
g + geom_jitter((aes(col = prediction, alpha = 0.4)))
?abs
1-2
abs(1-2)
n_wrong <- abs(class - prob) > 0.5
loss_func <- function(class, prob) {
n_wrong <- abs(class - prob) > 0.5
mean(n_wrong)
}
loss_func(class = alc$high_use, prob = 0)
?cv.glm
